<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products Demo - Spring Boot + HTMX</title>

    <!-- Web Awesome CSS -->
    <link rel="stylesheet" href="https://early.webawesome.com/webawesome@3.0.0-beta.5/dist/styles/webawesome.css" />
    <script type="module" src="https://early.webawesome.com/webawesome@3.0.0-beta.5/dist/webawesome.loader.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="/css/styles.css" />

    <!-- HTMX -->
    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js"></script>

</head>
<body>
<div class="container">
    <!-- Header Card -->
    <div class="card">
        <div class="card-header">
            <h1 class="card-title">
                <i class="fas fa-shopping-cart"></i>
                Products Demo
            </h1>
            <p class="card-subtitle">
                Modern Spring Boot application with HTMX, Thymeleaf, and Web Awesome components
            </p>
        </div>
        <!-- Add Product Form -->
        <div class="form-section" id="add-product-form">
            <div class="form-header">
                <h2 class="form-title">
                    <i class="fas fa-plus-circle"></i>
                    Add New Product
                </h2>
            </div>
            <div class="form-body">
                <form hx-post="/products"
                      hx-target="#products-table-container"
                      hx-swap="innerHTML"
                      hx-on::after-request="alert('hello');this.reset()">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="title" class="form-label">Product Title *</label>
                            <input type="text"
                                   id="title"
                                   name="title"
                                   class="form-control"
                                   required
                                   placeholder="Enter product title">
                        </div>
                        <div class="form-group">
                            <label for="vendor" class="form-label">Vendor/Brand</label>
                            <input type="text"
                                   id="vendor"
                                   name="vendor"
                                   class="form-control"
                                   placeholder="Enter vendor name">
                        </div>
                        <div class="form-group">
                            <label for="product_type" class="form-label">Product Type</label>
                            <input type="text"
                                   id="product_type"
                                   name="product_type"
                                   class="form-control"
                                   placeholder="e.g., Clothing, Electronics">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-success btn-lg">
                        <i class="fas fa-save"></i>
                        Add Product
                    </button>
                </form>
            </div>
        </div>

        <div class="card-body">
            <button class="btn btn-primary btn-lg"
                    hx-get="/products?currentPage=0&pageSize=10"
                    hx-target="#products-table-container"
                    hx-swap="innerHTML">
                <i class="fas fa-download"></i>
                Load Products from Database
            </button>
        </div>

    </div>

    <!-- Products Table Container -->
    <div class="table-container" id="products-table-container">
        <div class="empty-state">
            <i class="fas fa-box-open"></i>
            <h3>No Products Loaded</h3>
            <p>Click "Load Products" to fetch products from the database</p>
        </div>
    </div>


</div>

<script>
    function showAddForm() {
        const form = document.getElementById('add-product-form');
        form.classList.add('show');
    }

    // HTMX event listeners
    document.body.addEventListener('htmx:beforeRequest', function(evt) {
        evt.target.classList.add('loading');
    });

    document.body.addEventListener('htmx:afterRequest', function(evt) {
        evt.target.classList.remove('loading');
    });

    // Auto-show form after successful product load
    document.body.addEventListener('htmx:afterSwap', function(evt) {
        if (evt.target.id === 'products-table-container' && evt.detail.xhr.status === 200) {
            showAddForm();
        }
    });
</script>
</body>
</html>